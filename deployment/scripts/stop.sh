#!/bin/bash
# ==========================================
# Twenty CRM 停止腳本
# ==========================================
# 安全停止所有服務
# ==========================================

set -e

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
PROJECT_DIR="$(dirname "$SCRIPT_DIR")"

echo "🛑 Twenty CRM 停止腳本"
echo "=========================================="
echo ""

# 進入專案目錄
cd "$PROJECT_DIR"

# ==========================================
# 停止服務
# ==========================================
echo "1️⃣  停止所有服務..."

docker compose down

echo "   ✅ 所有服務已停止"
echo ""

# ==========================================
# 顯示狀態
# ==========================================
echo "2️⃣  檢查狀態..."

if docker compose ps | grep -q "Up"; then
    echo "   ⚠️  仍有服務在運行："
    docker compose ps
else
    echo "   ✅ 所有服務已停止"
fi
echo ""

echo "=========================================="
echo "✅ 完成！"
echo "=========================================="
echo ""
echo "💡 重新啟動："
echo "   bash scripts/deploy.sh"
echo ""
