# 雙因素驗證（2FA）文案修改指南

## 📍 文案位置分析

您看到的這些文案來自 **Twenty CRM 的雙因素身份驗證設置頁面**。

---

## 🎯 問題中的文案對應

### 1️⃣ "雙因素身份驗證"（標題）
**英文原文**: `Two Factor Authentication`

**源代碼位置**:
- **文件**: `packages/twenty-front/src/pages/settings/SettingsTwoFactorAuthenticationMethod.tsx`
- **行號**: 第 117 行
```typescript
title={t`Two Factor Authentication`}
```

**翻譯文件位置**:
- **文件**: `packages/twenty-front/src/locales/zh-TW.po`
- **搜索**: `msgid "Two Factor Authentication"`

---

### 2️⃣ "刪除雙重身份驗證方法"（子標題）
**英文原文**: `Delete Two-Factor Authentication Method`

**源代碼位置**:
- **文件**: `packages/twenty-front/src/modules/settings/two-factor-authentication/components/DeleteTwoFactorAuthenticationMethod.tsx`
- **行號**: 第 88 行
```typescript
title={t`Delete Two-Factor Authentication Method`}
```

**翻譯文件位置**:
- **文件**: `packages/twenty-front/src/locales/zh-TW.po`
```po
msgid "Delete Two-Factor Authentication Method"
msgstr "刪除雙重身份驗證方法"
```

---

### 3️⃣ "刪除此方法將永久從您的帳戶移除。"（描述文字）
**英文原文**: `Deleting this method will remove it permanently from your account.`

**源代碼位置**:
- **文件**: `packages/twenty-front/src/modules/settings/two-factor-authentication/components/DeleteTwoFactorAuthenticationMethod.tsx`
- **行號**: 第 89 行
```typescript
description={t`Deleting this method will remove it permanently from your account.`}
```

**翻譯文件位置**:
- **文件**: `packages/twenty-front/src/locales/zh-TW.po`
```po
msgid "Deleting this method will remove it permanently from your account."
msgstr "刪除此方法將永久從您的帳戶移除。"
```

---

## 🔧 如何修改這些文案

### 方法 1: 修改繁體中文翻譯文件（推薦）

**文件路徑**: `packages/twenty-front/src/locales/zh-TW.po`

**修改步驟**:

1. **打開翻譯文件**:
```bash
code packages/twenty-front/src/locales/zh-TW.po
```

2. **搜索並修改文案**:
```po
# 修改前
msgid "Delete Two-Factor Authentication Method"
msgstr "刪除雙重身份驗證方法"

# 修改後（示例）
msgid "Delete Two-Factor Authentication Method"
msgstr "移除雙因素驗證方式"
```

```po
# 修改前
msgid "Deleting this method will remove it permanently from your account."
msgstr "刪除此方法將永久從您的帳戶移除。"

# 修改後（示例）
msgid "Deleting this method will remove it permanently from your account."
msgstr "此操作將永久移除您帳戶中的驗證方式。"
```

3. **編譯翻譯文件**:
```bash
cd packages/twenty-front
npx lingui compile
```

4. **重新啟動前端**:
```bash
# 如果是 development 模式
npx nx run twenty-front:start

# 如果是 production 模式
npx nx run twenty-front:build
```

---

### 方法 2: 直接修改源代碼（不推薦）

**文件路徑**: `packages/twenty-front/src/modules/settings/two-factor-authentication/components/DeleteTwoFactorAuthenticationMethod.tsx`

**修改範例**:
```typescript
// 第 88-89 行
<H2Title
  title={t`刪除雙因素驗證方式`}  // 直接使用中文
  description={t`此操作將永久移除您帳戶中的驗證方式。`}  // 直接使用中文
/>
```

⚠️ **不推薦原因**: 
- 破壞國際化架構
- 其他語言無法使用
- 維護困難

---

## 📂 相關文件清單

### 1. 源代碼文件
```
packages/twenty-front/src/modules/settings/two-factor-authentication/
├── components/
│   ├── DeleteTwoFactorAuthenticationMethod.tsx  ← 主要組件
│   ├── TwoFactorAuthenticationSetupForSettingsEffect.tsx
│   └── TwoFactorAuthenticationVerificationForSettings.tsx
├── hooks/
│   ├── useCurrentUserWorkspaceTwoFactorAuthentication.ts
│   └── useTwoFactorVerificationForSettings.ts
└── graphql/
    └── mutations/
        └── verifyTwoFactorAuthenticationMethod.ts
```

### 2. 頁面文件
```
packages/twenty-front/src/pages/settings/
└── SettingsTwoFactorAuthenticationMethod.tsx  ← 2FA 設置頁面
```

### 3. 翻譯文件
```
packages/twenty-front/src/locales/
├── zh-TW.po  ← 繁體中文翻譯
├── zh-CN.po  ← 簡體中文翻譯
└── en.po     ← 英文（原始文案）
```

---

## 🔍 所有相關的 2FA 文案

在 `zh-TW.po` 中搜索這些 msgid 可以找到所有相關文案：

| 英文原文 | 繁體中文翻譯 | 行號 |
|---------|-------------|------|
| `Two Factor Authentication` | 雙因素身份驗證 | - |
| `Delete Two-Factor Authentication Method` | 刪除雙重身份驗證方法 | - |
| `Deleting this method will remove it permanently from your account.` | 刪除此方法將永久從您的帳戶移除。 | - |
| `Reset 2FA` | 重置 2FA | - |
| `2FA Method Reset` | 2FA 方法重置 | - |
| `2FA Method has been deleted successfully.` | 2FA 方法已成功刪除。 | - |
| `Invalid 2FA information.` | 無效的 2FA 信息。 | - |
| `Two-factor authentication setup completed successfully!` | 雙因素身份驗證設置成功完成！ | - |

---

## 🎨 Google Authenticator 中的顯示

Google Authenticator 應用中顯示的**帳戶名稱**來自於：

**文件**: `packages/twenty-server/src/modules/user/services/user.service.ts`

**搜索關鍵字**: `otpauth://totp/`

這個是後端生成的 OTP URI，格式通常是：
```
otpauth://totp/Twenty:user@example.com?secret=XXX&issuer=Twenty
```

如果要修改 Google Authenticator 中顯示的名稱，需要修改後端的 OTP URI 生成邏輯。

---

## ✅ 建議的修改流程

1. **修改翻譯文件** (`zh-TW.po`)
2. **編譯翻譯** (`npx lingui compile`)
3. **重新 Build 前端** (production 模式)
4. **重啟服務** (`bash start_all_service_start.sh`)
5. **清除瀏覽器快取**
6. **重新登入查看效果**

---

## 💡 Lingui 國際化框架說明

Twenty CRM 使用 **Lingui** 進行國際化：

- **標記文案**: `t\`Text\``（模板字串）
- **編譯命令**: `npx lingui extract`（提取文案）→ `npx lingui compile`（編譯）
- **翻譯格式**: `.po` 文件（Gettext 格式）

---

## 📝 常用命令

```bash
# 提取所有需要翻譯的文案
cd packages/twenty-front
npx lingui extract

# 編譯翻譯文件
npx lingui compile

# 查看所有 2FA 相關文案
grep -i "two.*factor\|2fa" packages/twenty-front/src/locales/zh-TW.po

# 查看具體文件中的文案使用
grep -r "t\`.*Two Factor" packages/twenty-front/src
```

---

## 🔗 相關文檔

- **Lingui 官方文檔**: https://lingui.dev/
- **Twenty 翻譯指南**: `packages/twenty-front/README.md`
- **Gettext .po 格式**: https://www.gnu.org/software/gettext/manual/html_node/PO-Files.html
